<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WAKASA! - 若狭県総合ポータル</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header class="site-header">
        <div class="logo-area">
            <h1><span class="red">WAKASA</span><span class="blue">!</span></h1>
            <p class="subtitle">若狭県最大級の地域ポータル</p>
        </div>
        <div class="header-info">
            <div id="clock-display" class="clock">0000年0月0日(月) 00:00:00</div>
        </div>
    </header>

    <div class="status-bar2">
    <span class="label2">ライブ天気予報</span>
    <marquee scrollamount="3" class="weather-ticker" id="weather-display">
        データを取得中...
    </marquee>
</div>

<script>
async function updateWeather() {
    // 緯度・経度の設定（沿岸=敦賀付近, 中央=小浜付近, 南部=舞鶴付近）
    const locations = [
        { label: "沿岸", lat: 35.64, lon: 136.06 },
        { label: "中央", lat: 35.49, lon: 135.74 },
        { label: "南部", lat: 35.47, lon: 135.33 }
    ];

    // 天気コードを日本語に変換するマップ
    const weatherCodes = {
        0: "晴れ", 1: "概ね晴れ", 2: "時々曇り", 3: "曇り",
        45: "霧", 48: "霧", 51: "小雨", 53: "雨", 55: "雨",
        61: "雨", 63: "雨", 65: "強い雨", 71: "雪", 73: "雪", 75: "大雪",
        80: "にわか雨", 81: "強いにわか雨", 82: "激しい雨", 95: "雷雨"
    };

    try {
        const results = await Promise.all(locations.map(async (loc) => {
            const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${loc.lat}&longitude=${loc.lon}&current_weather=true&timezone=Asia%2FTokyo`);
            const data = await response.json();
            const temp = Math.round(data.current_weather.temperature);
            const condition = weatherCodes[data.current_weather.weathercode] || "不明";
            return `[${loc.label}]${condition} ${temp}℃`;
        }));

        // 取得したデータを marquee に反映
        document.getElementById('weather-display').innerText = results.join(' / ');
    } catch (error) {
        document.getElementById('weather-display').innerText = "データ取得に失敗しました";
        console.error("Weather API Error:", error);
    }
}

// ページ読み込み時に実行
updateWeather();
// 30分ごとに更新（1800000ミリ秒）
setInterval(updateWeather, 1800000);
</script>

    <div class="status-bar">
        <span class="label">インフラ情報</span>
        <marquee scrollamount="5" class="ticker">
            【鉄道】県内路線：通常運転　【道路】三都高速道路：兵府IC付近で工事渋滞　【電力】県内全域：安定供給中　【行政】兵府市役所：本日は20時まで窓口延長
        </marquee>
    </div>

    <div class="main-container">
        
        <nav class="sidebar-left">
            <div class="box-header">主要エリア（三都）</div>
            <ul class="link-list">
                <li><a href="./Town Pages/wakasa.html">若狭市</a></li>
                <li><a href="./Town Pages/byobu.html">兵府市</a></li>
                <li><a href="#">物部市</a></li>
            </ul>

            <div class="box-header">沿岸エリア</div>
            <ul class="link-list">
                <li><a href="#">香津村</a></li>
                <li><a href="#">渡町</a></li>
                <li><a href="#">汐崖町</a></li>
                <li><a href="#">伊舟市</a></li>
                <li><a href="#">早手川町</a></li>
                <li><a href="#">矢坂町</a></li>
                <li><a href="#">江崎市</a></li>
                <li><a href="#">葉が山町</a></li>
            </ul>

            <div class="box-header">中部・南部エリア</div>
            <ul class="link-list">
                <li><a href="#">甲日市</a></li>
                <li><a href="#">氏川町</a></li>
                <li><a href="#">徳峰町</a></li>
                <li><a href="#">入塚市</a></li>
                <li><a href="#">深山町</a></li>
                <li><a href="#">折鷲市</a></li>
                <li><a href="#">北陵市</a></li>
                <li><a href="#">白央市</a></li>
                <li><a href="#">千鳴村</a></li>
                <li><a href="#">朝渕村</a></li>
                <li><a href="#">丹谷町</a></li>
                <li><a href="#">小桟田町</a></li>
            </ul>
        </nav>

        <main class="content-center">
            
            <section class="news-section">
    <div class="news-header">
        <h2>若狭トピックス</h2>
        <span class="update-time">最終更新: <span id="last-update">--:--</span></span>
    </div>
    <div class="tabs">
        <button class="tab active" data-category="main">主要</button>
        <button class="tab" data-category="local">地域</button>
        <button class="tab" data-category="economy">経済</button>
    </div>
    <ul class="news-list" id="news-container">
        </ul>
    <div id="more-link-container" style="text-align: right; padding: 5px 10px; font-size: 12px; background: #f9f9f9; border-top: 1px dotted #ccc;">
        <a href="news.html" id="more-link" style="color: #0033cc; text-decoration: none;">（もっと見る…）</a>
    </div>
</section>

            <section class="tools-section">
                <h3>▼ くらしの便利ツール</h3>
                <div class="tool-grid">
                    <div class="tool-item">
                        <a style="text-decoration: none;" href="./gomidashi.html">
                            <div class="icon">🗑️</div>
                            <div class="label">ゴミ出し</div>
                        </a>
                    </div>
                    <div class="tool-item">
                        <div class="icon">🏥</div>
                        <div class="label">当番医</div>
                    </div>
                    <div class="tool-item">
                        <div class="icon">🚌</div>
                        <div class="label">バス位置</div>
                    </div>
                    <div class="tool-item">
                        <div class="icon">🥬</div>
                        <div class="label">直売所</div>
                    </div>
                </div>
            </section>

            <section class="event-section">
                <div class="box-header">県内のイベント情報</div>
                <ul class="event-list">
                    <li>
                        <span class="event-date">1/5(日)</span>
                        <span class="event-title">【若狭市】新春・大凧揚げ大会（若狭中央公園）</span>
                    </li>
                    <li>
                        <span class="event-date">1/12(日)</span>
                        <span class="event-title">【江崎市】寒ブリ祭り・即売会（江崎漁港）</span>
                    </li>
                    <li>
                        <span class="event-date">1/18(土)</span>
                        <span class="event-title">【折鷲市】冬の星座観測会（折鷲高原レジャーランド）</span>
                    </li>
                </ul>
            </section>
        </main>

        <aside class="sidebar-right">
            <div class="login-box" id="auth-box">
                <div id="logged-out-view">
                    <p>こんにちは、<b>ゲスト</b>さん</p>
                    <button class="btn-primary" id="login-btn">若狭IDでログイン</button>
                    <p class="small-text"><a href="./register.html" id="signup-link">新規会員登録はこちら</a></p>
                </div>

                <div id="logged-in-view" style="display: none;">
                    <p>こんにちは、<b id="user-display-name">---</b>さん</p>
                    <p class="point-display">現在のポイント: <span id="user-points">0</span> pt</p>
                    <button class="btn-secondary" id="logout-btn">ログアウト</button>
                </div>
            </div>

            <div class="mission-box" id="mission-area" style="display: none;">
                <button id="get-point-btn">🎁 今日の来県ポイントをもらう</button>
            </div>
            <span style="margin: 1px;"></span>
            <div class="ad-area">
                <div class="box-header2">広告エリア</div>
                <div class="ad-banner">
                    <a style="text-decoration: none; text-align: center; display: block; color: #595959;" href="https://fictional-railway.github.io/Ezaki-ITpark">
                    <p>【求人】海が見えるオフィス</p>
                    <p>詳細はこちらから</p>
                    <strong>江崎ITパーク</strong>
                    </a>
                </div>
                <div class="ad-banner2">
                    <a style="text-decoration: none; text-align: center; display: block; color: #595959;" href="https://fictional-railway.github.io/Ifunesan-Bus/">
                        <p>心にしまった夢、もう一度かなえてみませんか？</p>
                        <p>伊舟山バスでは運転手を募集しております。</p>
                        <strong>伊舟山交通</strong>
                    </a>
                </div>
                <div class="ad-banner2">
                    <a style="text-decoration: none; text-align: center; display: block; color: #595959;" href="https://fictional-railway.github.io/Ifunesan-Bus/">
                        <p>この冬は汐崖温泉街へ！</p>
                        <p>現在汐崖町全商業施設で冬割実施中</p>
                        <strong style="color: darkgreen;">汐崖町/汐崖温泉協会/<span style="color: #0b81ff;">若狭海岸鉄道/<span style="color: #000;">日本国有鉄道</span></strong>
                    </a>
                </div>
                
            </div>
        </aside>

    </div>

    <footer>
        <p class="copyright">Copyright (C) 2025 WAKASA Prefecture Portal. All Rights Reserved.</p>
        <p class="disclaimer">※このサイトは架空のものです。</p>
        <a style="color: rgb(87, 182, 255);" href="https://fictional-railway.github.io/myrailways/">架空鉄道一覧はこちらから</a><br><br>
    </footer>

    <script src="script.js"></script>
</body>
</html>